{% extends "layout.html" %}

{% block head %}
      <script type="text/javascript">
          $(document).ready( function() {
              results_page();
          });
      </script>
{% endblock head %}

{% block content %}

<div class="container-fluid">
    <form id="form" method="Post" action="unset" enctype="multipart/form-data">

        <div class="row">
            <h4>MCL clustering</h4>
                <div class="col-md-6">
                    <span>The aim of the clustering approach is to group results (i.e. rows of the resulting output table below) associated with similar sets of accession numbers.
                        Enter a number higher than 1 as the inflation factor. Usually a number between 1.1 and 10 is chosen. Increasing the value will increase cluster granularity (produce more clusters).
                        Some combinations of data and inflation factor can take very long to process. Please be patient. The maximum time for clustering is set to {{ maximum_time }} min.
                        If this limit is exceeded, MCL is interrupted and the original results will be displayed.</span>
                </div>

                <div class="col-md-6">
                    <span title="{{ form.inflation_factor.description }}" class="inflation_factor"> {{ form.inflation_factor.label }}: {{ form.inflation_factor}}</span>
                        {% if form.inflation_factor.errors %}
                        <ul class="errors"> {% for error in form.inflation_factor.errors %} <b> {{ error }} </b> {% endfor %} </ul>
                        {% endif %}
                    <button id="submit_mcl" type="button" onclick="submit_form('form', 'results_clustered')" class="btn btn-primary">MCL</button>
                {% for error in errors %}
                    <div style="color: red;">{{ error }}</div>
                {% endfor %}
                </div>
        </div>
        <br>

        <div class="row">
            <h4>Filter hierarchy</h4>
                <div class="col-md-6">
                    <span>The aim of this processing step is to reduce the plethora of results (i.e. the number of GO-terms) to a clear and concise subset thereof, without
                        loosing essential information. See <a href="{{ url_for('parameters') }}">parameters</a> for more information.</span>
                </div>
                <div class="md-col-6">
                    <button id="submit_filter" type="button" onclick="submit_form('form', 'results_filtered')" class="btn btn-primary">Filter</button>
                </div>
        </div>
        <br>

        <input type="hidden" style="display: none;" name="session_id" value="{{ session_id }}">
        <input type="hidden" style="display: none;" name="limit_2_entity_type" value="{{ limit_2_entity_type }}">
        <input type="hidden" style="display: none;" name="indent" value="{{ indent }}">

    </form>

        <div class="row">
            <h4>Download results file</h4>
{#            <a name="file_path" href="{{ file_path }}" class="btn btn-primary">Download results</a>#}
            <a name="file_path" href="{{ url_for('download_results_data', filename=file_path) }}" class="btn btn-primary">Download results</a>
        </div>
        <br>
</div>

{% endblock content %}


{% block table %}
    <table id="table_id" class="table table-striped hover">
        <thead>
            <tr>
            {% for h in header%}
                <th><span class="table_header">{{ h.replace('_', ' ') }}</span></th>
            {% endfor %}
            </tr>
        </thead>
         <tbody>
         {% for result_row in results %}
             <tr>
             {% for r in result_row %}
                 <td title="click to show all"><div class="ellipsis long_row" onclick="toggle_ellipsis(this)">{{ r }}</div></td>
             {% endfor %}
             </tr>
         {% endfor %}
         </tbody>
    </table>
{% endblock table %}



