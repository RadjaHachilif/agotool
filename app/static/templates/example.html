{% extends "layout.html" %}

{% block head %}
        <link rel="stylesheet" href="{{ url_for('static', filename='css/prism.css') }}">
{% endblock head %}

{% block content %}
    <script src="{{ url_for('static', filename='js/prism.js') }}"></script>
<div class="container-fluid">
    <h3>Example data</h3>
    <br>
    Look at the
    <td><a href="{{ url_for('download_example_data', filename='ExampleData.txt') }}">example data</a> for comparison.</td>
    <p>please right click the download link to 'save link as'</p>
    <br>
    <p>
    The example data (Yeast) can be submitted using the default settings for either the GO-terms or UniProt-keywords page.<br>
        It contains Yeast data for the observed proteome ('background' and 'intensity') as well as Yeast acetylation data ('foreground').
        <br>The results (using default settings) should look like this:
        <td><a href="{{ url_for('download_example_data', filename='ExampleData_GObasic_results_orig.txt') }}">GO-term (basic) results</a> and</td>
        <td><a href="{{ url_for('download_example_data', filename='ExampleData_UniProtKeywords_results_orig.txt') }}">UniProt-keywords results</a></td>

    <h2>REST API</h2>
    <p>
        current version of agotool using UniProt Accession Numbers at https://agotool.sund.ku.dk which will migrate to www.agotool.org soon
    </p>

<h3>Parameters</h3>
    <table id="table_id" class="table table-striped hover">
        <thead><span class="table_header">
            <tr>
            <th style="text-align:center;">Name</th>
            <th style="text-align:center;">DataType</th>
            <th style="text-align:center;">Required/Optional</th>
            <th style="text-align:center;">Default</th>
            <th style="text-align:center;">Description</th>
            <th style="text-align:center;">Example</th>
            </tr></span>
        </thead>
    <tbody>
        <tr>
        <td style="text-align:center;">foreground</td>
        <td style="text-align:center;">string</td>
        <td style="text-align:center;">required</td>
        <td style="text-align:center;">None</td>
        <td style="text-align:center;">STRING identifier(s) for all proteins in the test group (the foreground, the sample, the group you want to examine for GO term enrichment)</td>
        <td style="text-align:center;">"4932.YAR019C%04932.YFR028C"</td>
        </tr>
        <tr>
        <td style="text-align:center;">taxid</td>
        <td style="text-align:center;">integer</td>
        <td style="text-align:center;">only required if enrichment_method is "genome"</td>
        <td style="text-align:center;">None</td>
        <td style="text-align:center;">NCBI taxon identifiers (e.g. Human is 9606, see: STRING organisms)</td>
        <td style="text-align:center;">9606</td>
        </tr>
        <tr>
        <td style="text-align:center;">output_format</td>
        <td style="text-align:center;">string</td>
        <td style="text-align:center;">optional</td>
        <td style="text-align:center;">json</td>
        <td style="text-align:center;">The desired format of the output, one of {tsv, tsv-no-header, json, xml}</td>
        <td style="text-align:center;">tsv</td>
        </tr>
        <tr>
        <td style="text-align:center;">limit_2_entity_type</td>
        <td style="text-align:center;">string</td>
        <td style="text-align:center;">optional</td>
        <td style="text-align:center;">"-21;-22;-23;-51;-52;-53;-54;-55" (all available)</td>
        <td style="text-align:center;">Limit the enrichment analysis to a specific or multiple entity types</td>
        <td style="text-align:center;">'-21' (for GO molecular function) or '-21;-22;-23;-51' (for all GO terms as well as UniProt Keywords"</td>
        </tr>
        <tr>
        <td style="text-align:center;">enrichment_method</td>
        <td style="text-align:center;">string</td>
        <td style="text-align:center;">required</td>
        <td style="text-align:center;">genome</td>
        <td style="text-align:center;">one of {genome, abundance_correction, compare_samples, compare_groups}. abundance_correction: Foreground vs Background abundance corrected; genome: provided foreground vs genome; compare_samples: Foreground vs Background (no abundance correction); compare_groups: Foreground(replicates) vs Background(replicates), --&gt; foreground_n and background_n need to be set; characterize_foreground: Foreground only</td>
        <td style="text-align:center;">genome</td>
        </tr>
        <tr>
        <td style="text-align:center;">background</td>
        <td style="text-align:center;">string</td>
        <td style="text-align:center;">optional (not required for 'enrichment_method' 'genome')</td>
        <td style="text-align:center;">None</td>
        <td style="text-align:center;">STRING identifier(s) for all proteins in the background (the population, the group you want to compare your foreground to)</td>
        <td style="text-align:center;">"4932.YAR019C%04932.YFR028C"</td>
        </tr>
        <tr>
        <td style="text-align:center;">intensity</td>
        <td style="text-align:center;">string</td>
        <td style="text-align:center;">optional (only required for 'enrichment_method' 'abundance_correction')</td>
        <td style="text-align:center;">None</td>
        <td style="text-align:center;">Protein abundance (intensity) for all proteins (copy number, iBAQ, or any other measure of abundance). Separate the list using '%0d'. The number of items should correspond to the number of Accession Numbers of the 'background'</td>
        <td style="text-align:center;">'12.3%0d3.4'</td>
        </tr>
        <tr>
        <td style="text-align:center;">FDR_cutoff</td>
        <td style="text-align:center;">float</td>
        <td style="text-align:center;">optional</td>
        <td style="text-align:center;">None</td>
        <td style="text-align:center;">False Discovery Rate cutoff (threshold for multiple testing corrected p-values), 0 or not passing the parameter means no cutoff applied.</td>
        <td style="text-align:center;">0.001</td>
        </tr>
        <tr>
        <td style="text-align:center;">caller_identity</td>
        <td style="text-align:center;">string</td>
        <td style="text-align:center;">optional</td>
        <td style="text-align:center;">None</td>
        <td style="text-align:center;">Your identifier for us</td>
        <td style="text-align:center;"><a href="http://www.my_awesome_app.com">www.my_awesome_app.com</a></td>
        </tr>
        <tr>
        <td style="text-align:center;">species</td>
        <td style="text-align:center;">string</td>
        <td style="text-align:center;">deprecated</td>
        <td style="text-align:center;">None</td>
        <td style="text-align:center;">deprecated, please use 'taxid' instead</td>
        <td style="text-align:center;"></td>
        </tr>
        <tr>
        <td style="text-align:center;">organism</td>
        <td style="text-align:center;">string</td>
        <td style="text-align:center;">deprecated</td>
        <td style="text-align:center;">None</td>
        <td style="text-align:center;">deprecated, please use 'taxid' instead</td>
        <td style="text-align:center;"></td>
        </tr>
        <tr>
        <td style="text-align:center;">method</td>
        <td style="text-align:center;">string</td>
        <td style="text-align:center;">deprecated</td>
        <td style="text-align:center;">None</td>
        <td style="text-align:center;">deprecated</td>
        <td style="text-align:center;"></td>
        </tr>
        <tr>
        <td style="text-align:center;">enrichment</td>
        <td style="text-align:center;">string</td>
        <td style="text-align:center;">deprecated</td>
        <td style="text-align:center;">None</td>
        <td style="text-align:center;">deprecated</td>
        <td style="text-align:center;"></td>
        </tr>
        <tr>
        <td style="text-align:center;">identifiers</td>
        <td style="text-align:center;">string</td>
        <td style="text-align:center;">deprecated</td>
        <td style="text-align:center;">None</td>
        <td style="text-align:center;">Please use 'foreground' instead. Required parameter for multiple items</td>
        <td style="text-align:center;">"DRD1_HUMAN%0dDRD2_HUMAN"</td>
        </tr>
        </tbody>
    </table>

<h4>Entity types</h4>
    <table id="table_id" class="table table-striped hover">
        <thead>
            <span class="table_header">
            <tr>
            <th style="text-align:center;">entity_type</th>
            <th style="text-align:center;">description</th>
            </tr>
            </span>
        </thead>
        <tbody>
            <tr>
            <td style="text-align:center;">-21</td>
            <td style="text-align:center;">GO biological process</td>
            </tr>
            <tr>
            <td style="text-align:center;">-22</td>
            <td style="text-align:center;">GO cellular component</td>
            </tr>
            <tr>
            <td style="text-align:center;">-23</td>
            <td style="text-align:center;">GO molecular function</td>
            </tr>
            <tr>
            <td style="text-align:center;">-51</td>
            <td style="text-align:center;">UniProt keyword</td>
            </tr>
            <tr>
            <td style="text-align:center;">-52</td>
            <td style="text-align:center;">KEGG</td>
            </tr>
            <tr>
            <td style="text-align:center;">-53</td>
            <td style="text-align:center;">SMART</td>
            </tr>
            <tr>
            <td style="text-align:center;">-54</td>
            <td style="text-align:center;">Interpro</td>
            </tr>
            <tr>
            <td style="text-align:center;">-55</td>
            <td style="text-align:center;">PFAM</td>
            </tr>
            <tr>
            <td style="text-align:center;">-56</td>
            <td style="text-align:center;">PMID</td>
            </tr>
        </tbody>
    </table>


    <h3>Python3 examples</h3><br>
        <pre><code class="language-python">
import requests
# call api_help for help and argument defaults
response = requests.get(r"http://agotool.meringlab.org/api_help")
print(response.json())

url_ = r"http://agotool.meringlab.org/api" # atlas
        </code></pre>

        <h4>Example #1 from STRING</h4>
    <p><b>Protein name: trpA; Organism: Escherichia coli K12_MG1655</b></p>
            <pre><code class="language-python">
ENSPs = ['511145.b1260', '511145.b1261', '511145.b1262', '511145.b1263', '511145.b1264', '511145.b1812',
            '511145.b2551', '511145.b3117', '511145.b3360', '511145.b3772', '511145.b4388']
fg = "%0d".join(ENSPs)
result = requests.post(url_,
                  params={"output_format": "json",
                          "foreground": fg,
                          "enrichment_method": "genome",
                          "taxid": 511145})
result_json = result.json()
print("Enrichment results for the following entity types was calculated: \n", result_json.keys())
                </code></pre><br>

        <h4>Example #2 from STRING. Use iPython or Jupyter notebook or Jupyter lab to interactively view results as a pandas data frame</h4>
            <p><b>Protein name: CDC15; Organism: Saccharomyces cerevisiae</b></p>
            <pre><code class="language-python">
import pandas as pd
from io import StringIO

ENSPs = ['4932.YAR019C', '4932.YFR028C', '4932.YGR092W', '4932.YHR152W', '4932.YIL106W', '4932.YJL076W',
            '4932.YLR079W', '4932.YML064C', '4932.YMR055C', '4932.YOR373W', '4932.YPR119W']
fg = "%0d".join(ENSPs)
result = requests.post(url_,
                  params={"output_format": "tsv",
                          "foreground": fg,
                          "enrichment_method": "genome",
                          "taxid": 4932})
result = result.json()
print("Select an entity type from the available ones: ", result.keys())
df = pd.read_csv(StringIO(result["-51"]), sep='\t')
df.head()
            </code></pre><br>
        <h4>Example #3 from STRING</h4>
    <p><b>Protein name: trpA; Organism: Escherichia coli K12_MG1655</b></p>
            <pre><code class="language-python">
ENSPs = ['10090.ENSMUSP00000001812', '10090.ENSMUSP00000002708', '10090.ENSMUSP00000021921',
            '10090.ENSMUSP00000025791', '10090.ENSMUSP00000026474', '10090.ENSMUSP00000030443',
            '10090.ENSMUSP00000054837', '10090.ENSMUSP00000084430', '10090.ENSMUSP00000099623',
            '10090.ENSMUSP00000106137', '10090.ENSMUSP00000107498']
fg = "%0d".join(ENSPs)
result = requests.post(url_,
                  params={"output_format": "json",
                          "foreground": fg,
                          "background": fg,
                          "enrichment_method": "compare_samples",
                          "limit_2_entity_type": "-21;-51;-52", # comma separate desired entity_types (e.g. GO biological process; UniProt keyword; SMART) , default get all available.
                          "taxid": 10090})
# since the foreground equals the background completely no significant enrichment will result from this analysis
# it is meant to show how to show how to use the method call
result_json = result.json()
import ast
ast.literal_eval(result_json["-51"])
              </code></pre><br>
</div><br><br>
{% endblock content %}